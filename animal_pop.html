<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>animal_pop</title>
<link rel="icon" href="assets/images/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
<main>
  <div id="instructions">
    Pop the creatures!
  </div>

  <div id="game-area"></div>

  <div id="results">
    Pops: 0
  </div>

  <button id="start-btn">Start</button>
  <button id="stop-btn" style="display:none;">Stop</button>
  <button id="home-btn" onclick="location.href='index.html'">$ cd ~</button>
</main>

<script>
const gameArea = document.getElementById("game-area");
const results = document.getElementById("results");
const startBtn = document.getElementById("start-btn");
const stopBtn = document.getElementById("stop-btn");
const instructions = document.getElementById("instructions");

let popCount = 0, spawnInterval, testRunning = false;

const asciiCreatures = [
  { art: `+-----------+
|   /\\_/\\   |
|  ( o.o )  |
|   > ^ <   |
|           |
|           |
+-----------+`, color: "green" },

  { art: `+-----------+
|   ^__^    |
|  (oo)     |
|  (__)     |
|           |
|           |
+-----------+`, color: "cyan" },

  { art: `+-----------+
|   /\\_/\\   |
|  ( -.- )  |
|   zzz     |
|           |
|           |
+-----------+`, color: "red" },

  { art: `+-----------+
|   ()_()   |
|   (o.o)   |
|   > ^ <   |
|           |
|           |
+-----------+`, color: "yellow" },

  { art: `+-----------+
|    //     |
|   (oo)    |
|   /-/     |
|           |
|           |
+-----------+`, color: "pink" },

  { art: `+-----------+
|   ^__^    |
|  ('o')    |
|  (   )    |
|           |
|           |
+-----------+`, color: "orange" },

  { art: `+-----------+
|    ,~.    |
|   (o,o)   |
|   <) )â•¯   |
|           |
|           |
+-----------+`, color: "blue" },

  { art: `+-----------+
|    >>\\.   |
|   (o o)   |
|   /   \\   |
|           |
|           |
+-----------+`, color: "purple" }
];

function startTest() {
  popCount = 0;
  testRunning = true;
  instructions.textContent = "Pop the ASCII creatures!";
  results.textContent = `Pops: ${popCount}`;
  startBtn.style.display = "none";
  stopBtn.style.display = "inline-block";

  spawnInterval = setInterval(() => {
    for (let i = 0; i < 3; i++) {
      spawnCircle();
    }
  }, 700);
}

function endTest() {
  clearInterval(spawnInterval);
  testRunning = false;
  instructions.textContent = "Press Start then pop the ASCII creatures!";
  results.textContent = `Total pops: ${popCount}`;
  startBtn.style.display = "inline-block";
  stopBtn.style.display = "none";
  gameArea.innerHTML = "";
}

function spawnCircle() {
  const circle = document.createElement("div");
  circle.classList.add("circle");

  const creatureObj = asciiCreatures[Math.floor(Math.random() * asciiCreatures.length)];
  circle.textContent = creatureObj.art;
  circle.classList.add(creatureObj.color);

  gameArea.appendChild(circle);

  const circleWidth = circle.offsetWidth;
  const circleHeight = circle.offsetHeight;

  let top, left;
  let tries = 0;
  let overlap;

  do {
    top = Math.random() * (gameArea.clientHeight - circleHeight);
    left = Math.random() * (gameArea.clientWidth - circleWidth);

    overlap = false;
    const existingCircles = gameArea.querySelectorAll(".circle");
    existingCircles.forEach(c => {
      if (c === circle) return;
      const rect1 = { x: left, y: top, w: circleWidth, h: circleHeight };
      const rect2 = {
        x: parseFloat(c.style.left),
        y: parseFloat(c.style.top),
        w: c.offsetWidth,
        h: c.offsetHeight
      };

      if (!(rect1.x + rect1.w < rect2.x ||
            rect1.x > rect2.x + rect2.w ||
            rect1.y + rect1.h < rect2.y ||
            rect1.y > rect2.y + rect2.h)) {
        overlap = true;
      }
    });

    tries++;
    if (tries > 50) break;
  } while (overlap);

  circle.style.top = top + "px";
  circle.style.left = left + "px";

  circle.addEventListener("click", () => {
    if (testRunning) {
      popCount++;
      results.textContent = `Pops: ${popCount}`;

      // Pop animation
      circle.classList.add("pop");
      setTimeout(() => circle.remove(), 200);
    }
  });

  setTimeout(() => {
    if (gameArea.contains(circle)) circle.remove();
  }, 6000);
}

startBtn.addEventListener("click", startTest);
stopBtn.addEventListener("click", endTest);
</script>
</body>
</html>
